---
title: "Untitled"
author: "Grandez"
date: "19/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(knitr)
library(kableExtra)
library(rnaturalearth)
library(sp)
```

```{r code}
load = function() {
  df = read.csv2("lenguas2.csv", stringsAsFactors=TRUE)
  df$Idioma = tolower(df$Idioma)
  df$Subidioma = tolower(df$Subidioma)
  df   
}
tables = function(df) {
  df2 = df %>% group_by(Idioma) %>% summarise(Paises=n(), Poblacion=sum(Poblacion))   
  t1 = head(df2[order(df2$Paises, decreasing=T),],n=5)
  t2 = head(df2[order(df2$Poblacion, decreasing=T),],n=5)
  #knitr::kable(list(t1, t2))
  kable(t1) %>%
  kable_styling(full_width = FALSE, position = "float_left")
kable(t2) %>%
  kable_styling(full_width = FALSE, position = "right")
}
df = load()
```

## Mapa

```{r}
map <- ne_countries()
names(map)[names(map) == "iso_a3"] <- "ISO3"
names(map)[names(map) == "name"] <- "NAME"

plot(map)
```

## Codebook

Los datos han sido tomados de fuentes oficiales y especifican:

- Idioma: Idioma oficial o de facto
- Subidioma: Idioma cooficial
- Continente: Continente considerando Europa,Africa,Asia,America y Oceania
- Poblacion: Estimacion a 2021 en miles

Posiblemente no aparezcan ciertos paises que por su tamaño haya sido dificil de localizar o considerado irrelevante; por ejemplo Ciudad del Vaticano es un estado soberano con una poblacion estimada de 1.000 habitantes y ha sido conscientemente eliminado. Mis disculpas por esas omisiones.

## Consideraciones

El idioma oficial de Nigeria es el Ingles, sin embargo se usan mas de 500 lenguas en el pais, lo cual, unido a que la mayoria de la poblacion vive en zonas rurales y la enorme desigualdad social hace que de facto el Ingles sea usado por la minoria de las clases altas. Por lo que asumir que los 200M de poblacion del pais hablan ingles no seria realista.

Puerto Rico, como estado asociado de EEUU indica que el idioma oficial es el Ingles y el cooficial es el Castellano. La realidad, sin embargo es que los puertorriqueños se comunican en Castellano.

En la zona del caribe, la mayoria de los paises indican que el idioma oficial es el Ingles, sin embargo, el idioma usado en el uso diario es una variante del Criollo (Cada una de las islas tienen su variante).

Canada tiene dos lenguas oficiales, Frances e Ingles en funcion del Canadá francofono o el Canadá britanico. Para considerar este caso, Candá se ha dividido en dos partes, la francofona y la britanica segun lo datos oficiales del Dpto. de Estadistica de Canada:

70% Ingles
30% Frances

38248

## Resumen

Los datos que manejamos son:


Paises: `r nrow(df)`

Idiomas: `r length(unique(df$Idioma))`


## Agrupacion por numero de paises que hablan un mismo idioma

```{r}
#df2 = df %>% group_by(Idioma) %>% summarise(Paises=n(), Poblacion=sum(Poblacion))
tables(df)
```


Ahora quitamos los paises "pequeños"
```{r}
size=1000
dfp = df[df$Poblacion > size,]
tables(dfp)
```



## Por continentes


## Caso Africa

```{r}

tables(dfp[dfp$Continente == "Africa",])
tables(dfp[dfp$Continente == "Asia",])
tables(dfp[dfp$Continente == "America",])
tables(dfp[dfp$Continente == "Europ",])
```

## Caso especial EEUU

En EEUU oficialmente el 30% de la población tiene como lengua materna el castellano


# Caso nigeria:
# Idioma oficial Ingles, idiomas: 516, Ingles solo usado por las clases altas